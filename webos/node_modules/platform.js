var SDL = require('sdl');
var WebGL = require('webgl');

module.exports = function (width, height) {

  SDL.init(SDL.INIT.VIDEO);
  SDL.GL.setAttribute(SDL.GL.DOUBLEBUFFER, 1);

  var screen = SDL.setVideoMode(width, height, 0, SDL.SURFACE.OPENGL);
  SDL.events.on('QUIT', function () { process.exit(0); });
  WebGL.viewport(0, 0, screen.w, screen.h);
  console.dir(SDL.GL);
  var platform = {
    type: "nodeSDL",
    loadTexture: undefined,
    setTitle: setTitle,
    setIcon: setIcon,
    width: screen.w,
    height: screen.h,
    flip: SDL.GL.swapBuffers,
    gl: WebGL
  };

  return platform;

  function setTitle(title) {
    SDL.WM.setCaption(title, title);
  }

  function setIcon(path) {
    var img = SDL.IMG.load(path)
    SDL.WM.setIcon(img);
  }
};

